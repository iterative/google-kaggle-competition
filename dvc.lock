schema: '2.0'
stages:
  unzip_dataset:
    cmd: python src/stages/unzip_dataset.py
    deps:
    - path: data/baseline_split.zip
      md5: a10dceec1b22b1b3f4bc08e549ddf978
      size: 292752584
    - path: src/stages/unzip_dataset.py
      md5: 13e131dd90084e23ad49eec6031b798b
      size: 1028
    params:
      params.yaml:
        data:
          root: data
          dataset_baseline: images_128
          teacher_data: teacher_data
          train: baseline_split
    outs:
    - path: data/baseline_split
      md5: 22df0db38f0b7cf7486499b69e391c25.dir
      size: 294272494
      nfiles: 9347
  unzip_dataset@Dishes:
    cmd: python src/stages/unzip_dataset.py --teacher Dishes
    deps:
    - path: data/teacher_data/Dishes.zip
      md5: 9df78eee5fa02415ebf3d46b45a73c50
      size: 227445027
    - path: src/stages/unzip_dataset.py
      md5: 76423c7f1b0dbd58f01344dc9fb95eda
      size: 1006
    outs:
    - path: data/teacher_data/Dishes
      md5: b23cf150b12c80be59b94ca9a48ebc24.dir
      size: 227858517
      nfiles: 9000
  train_teacher_model@Dishes:
    cmd: python src/stages/train.py --teacher Dishes
    deps:
    - path: data/teacher_splitted/Dishes
      md5: 093f82c5da9bc9c4112630ac61c3b24d.dir
      size: 159616668
      nfiles: 6300
    - path: src/stages/train.py
      md5: c8bab7627a6fe37f871957cdd826313b
      size: 2961
    outs:
    - path: dvclive_Dishes.json
      md5: d901153a6ba2fd438bdd8279ce1499bc
      size: 126
    - path: dvclive_Dishes/scalars
      md5: d6919a6022ead89df1c51b1d58638454.dir
      size: 184
      nfiles: 3
    - path: models/teacher/Dishes/model.pt
      md5: 2ccdd02fe1b46272b718bb8e89c546c8
      size: 184593409
  unzip_dataset@Landmarks:
    cmd: python src/stages/unzip_dataset.py --teacher Landmarks
    deps:
    - path: data/teacher_data/Landmarks.zip
      md5: 350c8ab421310f9717eac242faa3b409
      size: 638370990
    - path: src/stages/unzip_dataset.py
      md5: 4769d26ff7a1910c16fc15a6ef7ebd39
      size: 1011
    outs:
    - path: data/teacher_data/Landmarks
      md5: ed9b37f78567165ee5b8c769abe312f8.dir
      size: 650138566
      nfiles: 9466
  train_teacher_model@Landmarks:
    cmd: python src/stages/train.py --teacher Landmarks
    deps:
    - path: data/teacher_splitted/Landmarks
      md5: c3b295e14949f409d6e249f894a84b9d.dir
      size: 449196704
      nfiles: 6589
    - path: src/stages/train.py
      md5: 295732f3a22c7c452a7b8415fcf134cf
      size: 2556
    outs:
    - path: dvclive_Landmarks.json
      md5: 388768eabe6a9a2de6c5dae43ef1d31f
      size: 128
    - path: dvclive_Landmarks/scalars
      md5: 2c23d854e493e5bfecb8aa7b5ea259f8.dir
      size: 281
      nfiles: 3
  unzip_dataset@MNIST_exp:
    cmd: python src/stages/unzip_dataset.py --teacher MNIST_exp
    deps:
    - path: data/teacher_data/MNIST_exp.zip
      md5: 9e93d35c365afad58547dda9de1d9e20
      size: 31006560
    - path: src/stages/unzip_dataset.py
      md5: 76423c7f1b0dbd58f01344dc9fb95eda
      size: 1006
    outs:
    - path: data/teacher_data/MNIST_exp
      md5: fab796cd12e859f053717904e923682d.dir
      size: 23551113
      nfiles: 42000
  train_teacher_model@MNIST_exp:
    cmd: python src/stages/train.py --teacher MNIST_exp
    deps:
    - path: data/teacher_splitted/MNIST_exp
      md5: 969d28a80afa27ab23c1baff2e3465db.dir
      size: 16480205
      nfiles: 29394
    - path: src/stages/train.py
      md5: e1b20a391c217bcc743e9761f5ae13ba
      size: 2554
    outs:
    - path: dvclive_MNIST_exp.json
      md5: a1aef61345c46df60e4a248128570293
      size: 129
    - path: dvclive_MNIST_exp/scalars
      md5: 67d413471fdb069f7f179288156289a4.dir
      size: 1052
      nfiles: 3
  unzip_dataset@Benchmark:
    cmd: python src/stages/unzip_dataset.py --teacher Benchmark
    deps:
    - path: data/teacher_data/Benchmark.zip
      md5: bab53d2a224acc036298d77255996397
      size: 293155992
    - path: src/stages/unzip_dataset.py
      md5: 76423c7f1b0dbd58f01344dc9fb95eda
      size: 1006
    outs:
    - path: data/teacher_data/Benchmark
      md5: 2d35f1eb05bc40c5bb7ec7e7d12cc44f.dir
      size: 294272494
      nfiles: 9347
  train_teacher_model@Benchmark:
    cmd: python src/stages/train.py --teacher Benchmark
    deps:
    - path: data/teacher_splitted/Benchmark
      md5: cff20f4b24874586b3fd17e51a92c673.dir
      size: 205297725
      nfiles: 6540
    - path: src/stages/train.py
      md5: 67e966e2c1be026c7fc48a522e8727e8
      size: 2719
    outs:
    - path: models/teacher/Benchmark/model.pt
      md5: 7033b95edf2f03d50a82aaa568f9f187
      size: 54727797
    - path: reports/dvclive_Benchmark.json
      md5: 84af4c71427751c373a64a5336f15c42
      size: 130
    - path: reports/dvclive_Benchmark/scalars
      md5: 451769ce04835de4ec7164adba6f3ea9.dir
      size: 4927
      nfiles: 3
  visualise@Benchmark:
    cmd: python src/stages/visualise_embeddings.py --params=params.yaml --teacher
      Benchmark
    deps:
    - path: models/teacher/Benchmark/model.pt
      md5: 7033b95edf2f03d50a82aaa568f9f187
      size: 54727797
    - path: src/stages/visualise_embeddings.py
      md5: 1f2393a399028913172c4a11b7ff3459
      size: 2697
    outs:
    - path: reports/plots/Benchmark/embedding.png
      md5: 94a99bb857a30ef0e0890233b98ac3ca
      size: 162489
  train_model:
    cmd: python src/stages/train.py
    deps:
    - path: data/baseline_split
      md5: 22df0db38f0b7cf7486499b69e391c25.dir
      size: 294272494
      nfiles: 9347
    - path: src/stages/train.py
      md5: a14fb1c45839c3333f7698ca93854ce3
      size: 2482
    - path: src/utils/networks.py
      md5: bd9402f772e27d26ae4477b6b7fbb4c8
      size: 3627
    params:
      params.yaml:
        data:
          root: data
          dataset_baseline: images_128
          teacher_data: teacher_data
          train: baseline_split
        train:
          model_path: models
          model_file: saved_model.pt
          batch_size: 512
          margin: 5
          lr: 0.001
          epochs: 30
          embedding_size: 64
    outs:
    - path: models/saved_model.pt
      md5: 9f97edebc3d0557009a6e9615593ce3f
      size: 54928182
    - path: reports/dvclive.json
      md5: a30a7c82314ea2db05aec610dd7c8d89
      size: 132
    - path: reports/dvclive/scalars
      md5: ef2965e375a76743e2c4566f0565fefa.dir
      size: 3017
      nfiles: 3
  visualise:
    cmd: python src/stages/visualise_embeddings.py
    deps:
    - path: models/saved_model.pt
      md5: 9f97edebc3d0557009a6e9615593ce3f
      size: 54928182
    - path: src/stages/visualise_embeddings.py
      md5: 832443d17834d8f6a0c1051fda265219
      size: 2553
    params:
      params.yaml:
        reports:
          root: reports
          plots: plots
    outs:
    - path: reports/plots/embedding.png
      md5: 4fd13d5db20a7ce5ec3b9eac87bee7f5
      size: 124869
